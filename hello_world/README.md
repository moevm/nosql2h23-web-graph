# Скринкаст 
https://drive.google.com/file/d/1u3LUHfynvnRkrhf20vI8KfKG146dP4_Z/view?usp=drive_link

# Инструкция по запуску

### Настройка СУБД

1. Скачайте [Neo4j Desktop](https://neo4j.com/download/) с официального сайта (понадобится VPN, т.к. с российского ip не пропустит), либо с этого [Google Диска](https://drive.google.com/file/d/1d-bafVVUm4B7eA1Ekmh_mnVeN2ncGgPJ/view?usp=drive_link) (это тот же загрзучик, что и на сайте разработчиков) - регистрироваться в любом случае придется
2. Если у вашей ОС стоит русский интерфейс:
   
   При установке не предоставляется выбор пути для сохраннеия данных БД, потому в этом пути могут оказаться некорректные для чтения Neo4j Desktop символы (в частности, кириллица), отчего запустить БД станет невозможным - будут выдаваться ошибки. Чтобы это исправить, необходимо изменить путь для данных БД: для этого перейдите в настройки и измените Data path, после чего перезагрузите СУБД.
   ![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/f881b104-b4a4-4907-bf73-a8b301ca1357)
3. Создайте новый проект (в примере это `link_search`, в нем создайте локальную СУБД (в примере это `link_search DBMS`), в ней создайте БД (в примере это `test)`. Запустите и откройте ее с помощью Neo4j Browser (устанавливается по умолчанию)
   ![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/7ac2ff82-aa35-497f-89cf-08519a9f50aa)
4. В Neo4j Browser в первом же окне для заполенния введите команду `:server user add`, после чего создайте пользователя, заполнив логин и пароль и выставите роль администратора (в примере это `Anton_Korsunov` и `123456789` соответственно)
![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/f9fd7f67-0f41-4aff-9885-50569c48d9e1)
5. Закройте БД (кнопка `stop` в главном окне), щелкните левой кнопкой мыши по локальной СУБД и во вкладке `Plugins` установите плагин `APOC` (необходим для функций экспорта и импорта в формат `graphml`)
   ![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/336ab98c-7ace-4a9b-8854-208cbc478b9a)
6. Откройте файлы конфигурации СУБД (на скриншоте ниже показано, как это быстро сделать)
   ![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/a843b35d-b267-454c-8fa4-396d96b6d9ed)
В открывшейся папке обязательно должен быть `neo4j.conf`, также в официальной документации описано, что должен быть и `apoc.conf`, но на практике его нет, так что придется вручную его создать. В нем необходимо прописать две строчки:

`apoc.export.file.enabled=true`
`apoc.import.file.enabled=true`

![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/62ce3096-26b6-475c-9ed5-983f3a904c5d)

### Подключение к Python + запуск
В каталоге с README находится три файла с расширением .py. В `neo4jTools.py` был создан класс для подключения к СУБД и взаимодействия с ней на базовом уровне (экспорт, импорт, передача комманд в формате Cypher Query). В `argparse_settings.py` с помощью модуля `argparse` были созданы флаги для запуска скрипта через консоль. В `main.py` на скриншоте ниже в 7-ой строчке происходит подключение к СУБД. В параметре `user` указывается логин ранее созданного пользователя, а в `password` - пароль. 
![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/9bd38fd7-d670-429b-9a93-999338354005)

Для запуска скрипта существуют следующие флаги:
![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/f0d8d13a-b163-4672-a682-204bdfef4cdf)

Примеры запуска скрипта:
- `python main.py --dbs test --command "CREATE (n:Test {name:'test'})"` - в данном случае указывается, что команда предназначается для БД (флаг --dbs) с именем "test" (по умолчанию работа всегда с ней), далее указывается команда в формате Cypher Query (флаг --command). В результате работы, если БД "test" существует, то в ней будет создана вершина с Label "Test" и со свойством name="test".

- `python main.py --dbs test --command "MATCH (n:Test) DETACH DELETE n"` - структурно выполняет то же самое, что и команда выше, но в результате исполнения Cypher Query в БД "test" будут удалены все вершины и их связи с Label="Test"

- `python main.py --dbs test --DBSprint 1` - выводит данные БД "test" в консоль (стоит сказать, что это очень не наглядно, лучше посмотреть экспортируемый graphml, а еще лучше посмотреть в самой СУБД - в ней присутствуют очень наглядные средства визуализации данных в виде графа)

- `python main.py --dbs neo4j --import_ test` - импорт файла "test.graphml" в БД "neo4j" (файл будет находится в файлах вашей СУБД в папке import)
   ![image](https://github.com/moevm/nosql2h23-web-graph/assets/54939750/420d9920-d5dd-441d-a4fb-bcdb7c1647ef)

- `python main.py --dbs test --export test` - экспорт БД "test" в файл "test.graphml"










